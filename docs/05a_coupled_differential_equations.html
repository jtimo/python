<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.53">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>9&nbsp; Dynamics of Coupled Differential Equations – Python for Engineers and Scientists (v1.0)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08a_partial_differential_equations.html" rel="next">
<link href="./08_scientific_computing_using_scipy.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/book_cover.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Python for Engineers and Scientists (v1.0)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./00_part_3.html">Part 3: Applications</a></li><li class="breadcrumb-item"><a href="./05a_coupled_differential_equations.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dynamics of Coupled Differential Equations</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./00_part_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 1: Core Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_representing_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Representation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_control_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Control Structures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_writing_programs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Programs and Functions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./00_part_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 2: Advanced Data Structures and Operations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Arrays and Array Operations using NumPy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Dataframes and Series for Data Wrangling</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./00_part_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Part 3: Applications</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_visualization_using_matplotlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_scientific_computing_using_scipy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Scientific Python (SciPy)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05a_coupled_differential_equations.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dynamics of Coupled Differential Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08a_partial_differential_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Partial Differential Equations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_machine_learning_using_scikitlearn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Scikit-Learn for Machine Learning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-runge-kutta-method" id="toc-the-runge-kutta-method" class="nav-link active" data-scroll-target="#the-runge-kutta-method"><span class="header-section-number">9.1</span> The Runge-Kutta Method</a>
  <ul class="collapse">
  <li><a href="#how-it-works" id="toc-how-it-works" class="nav-link" data-scroll-target="#how-it-works"><span class="header-section-number">9.1.1</span> How It Works</a></li>
  <li><a href="#how-to-use-the-above-code" id="toc-how-to-use-the-above-code" class="nav-link" data-scroll-target="#how-to-use-the-above-code"><span class="header-section-number">9.1.2</span> How to Use the above Code</a></li>
  </ul></li>
  <li><a href="#visualization-functions-for-ode-solutions" id="toc-visualization-functions-for-ode-solutions" class="nav-link" data-scroll-target="#visualization-functions-for-ode-solutions"><span class="header-section-number">9.2</span> Visualization Functions for ODE Solutions</a></li>
  <li><a href="#lotka-volterra-predator-prey-model-with-competition" id="toc-lotka-volterra-predator-prey-model-with-competition" class="nav-link" data-scroll-target="#lotka-volterra-predator-prey-model-with-competition"><span class="header-section-number">9.3</span> Lotka-Volterra Predator-Prey Model with Competition</a></li>
  <li><a href="#competition-for-resources-model" id="toc-competition-for-resources-model" class="nav-link" data-scroll-target="#competition-for-resources-model"><span class="header-section-number">9.4</span> Competition for Resources Model</a></li>
  <li><a href="#coupled-oscillators-model" id="toc-coupled-oscillators-model" class="nav-link" data-scroll-target="#coupled-oscillators-model"><span class="header-section-number">9.5</span> Coupled Oscillators Model</a></li>
  <li><a href="#sir-model-with-immunization-and-birth-rate" id="toc-sir-model-with-immunization-and-birth-rate" class="nav-link" data-scroll-target="#sir-model-with-immunization-and-birth-rate"><span class="header-section-number">9.6</span> SIR Model with Immunization and Birth Rate</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">9.7</span> Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./00_part_3.html">Part 3: Applications</a></li><li class="breadcrumb-item"><a href="./05a_coupled_differential_equations.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dynamics of Coupled Differential Equations</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Dynamics of Coupled Differential Equations</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Ordinary Differential Equations (ODEs) are equations that involve functions and their derivatives. They are used to describe a wide range of phenomena in science and engineering, from the motion of celestial bodies to the growth of populations. Solving ODEs analytically can be challenging, especially for complex systems, so numerical methods are often employed to approximate solutions. One of the most widely used numerical methods is the Runge-Kutta method.</p>
<section id="the-runge-kutta-method" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="the-runge-kutta-method"><span class="header-section-number">9.1</span> The Runge-Kutta Method</h2>
<p>The Runge-Kutta method is a powerful technique for solving ODEs numerically. It is an iterative method that provides an approximate solution by advancing the solution in small steps, calculating intermediate points to achieve higher accuracy. Among the various forms of the Runge-Kutta method, the most commonly used is the fourth-order Runge-Kutta method, often simply referred to as “RK4”.</p>
<p>For a differential equation of the form<span class="math inline">\(\frac{dy}{dt} = f(y, t)\)</span>, the Runge-Kutta method can be used to approximate the solution<span class="math inline">\(y(t)\)</span>at time<span class="math inline">\(t + \Delta t\)</span>as follows:</p>
<p><span class="math display">\[
y_{n+1} = y_n + \frac{1}{6} (k_1 + 2k_2 + 2k_3 + k_4)
\]</span></p>
<p>where<span class="math inline">\(k_1 = \Delta t \cdot f(y_n, t_n)\)</span>,<span class="math inline">\(k_2 = \Delta t \cdot f(y_n + \frac{1}{2} k_1, t_n + \frac{1}{2} \Delta t)\)</span>,<span class="math inline">\(k_3 = \Delta t \cdot f(y_n + \frac{1}{2} k_2, t_n + \frac{1}{2} \Delta t)\)</span>, and<span class="math inline">\(k_4 = \Delta t \cdot f(y_n + k_3, t_n + \Delta t)\)</span>.</p>
<p>Below is the Python code for a single step of the fourth-order Runge-Kutta method:</p>
<div id="80c63280" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> runge_kutta_step(func, y, t, dt):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    k1 <span class="op">=</span> dt <span class="op">*</span> func(y, t)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    k2 <span class="op">=</span> dt <span class="op">*</span> func(y <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> k1, t <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> dt)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    k3 <span class="op">=</span> dt <span class="op">*</span> func(y <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> k2, t <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> dt)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    k4 <span class="op">=</span> dt <span class="op">*</span> func(y <span class="op">+</span> k3, t <span class="op">+</span> dt)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y <span class="op">+</span> (k1 <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> k2 <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> k3 <span class="op">+</span> k4) <span class="op">/</span> <span class="dv">6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="how-it-works" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="how-it-works"><span class="header-section-number">9.1.1</span> How It Works</h3>
<ol type="1">
<li><strong>Initialization</strong>:
<ul>
<li><code>func</code>: The function representing the ODE, which takes the current value <code>y</code> and time <code>t</code> as inputs and returns the derivative <code>dy/dt</code>.</li>
<li><code>y</code>: The current value of the dependent variable.</li>
<li><code>t</code>: The current time.</li>
<li><code>dt</code>: The time step size.</li>
</ul></li>
<li><strong>Intermediate Steps</strong>:
<ul>
<li><code>k1</code> is the slope at the beginning of the interval.</li>
<li><code>k2</code> is the slope at the midpoint of the interval, estimated using <code>k1</code>.</li>
<li><code>k3</code> is another slope at the midpoint of the interval, but estimated using <code>k2</code>.</li>
<li><code>k4</code> is the slope at the end of the interval, estimated using <code>k3</code>.</li>
</ul></li>
<li><strong>Combination of Slopes</strong>:
<ul>
<li>The final value of <code>y</code> is updated using a weighted average of these slopes. This weighted sum ensures that the method achieves fourth-order accuracy, meaning the error per step is proportional to (dt^5).</li>
</ul></li>
</ol>
</section>
<section id="how-to-use-the-above-code" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="how-to-use-the-above-code"><span class="header-section-number">9.1.2</span> How to Use the above Code</h3>
<p>To solve an ODE using the Runge-Kutta method, we repeatedly apply the <code>runge_kutta_step</code> function over the desired time range. Here is an example of how to use the method to solve a simple ODE:</p>
<div id="e5a614d7" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example ODE function: dy/dt = -2y</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dydt(y, t):</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> y</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial conditions</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>t0 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>tf <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Time array</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(t0, tf, dt)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Array to store solution</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> [y0]</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Solving the ODE</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y0</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ti <span class="kw">in</span> t[:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> runge_kutta_step(dydt, y, ti, dt)</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    ys.append(y)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert ys to a numpy array for easier handling</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.array(ys)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the result (optional)</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">3</span>))</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>plt.plot(t, ys, label<span class="op">=</span><span class="st">'Numerical Solution'</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'t'</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$y(t)$'</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="05a_coupled_differential_equations_files/figure-html/cell-3-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="05a_coupled_differential_equations_files/figure-html/cell-3-output-1.png" width="591" height="282" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>In this example, we define a simple ODE, set the initial conditions, and use a loop to apply the <code>runge_kutta_step</code> function repeatedly. The result is a numerical approximation of the solution over the specified time range.</p>
</section>
</section>
<section id="visualization-functions-for-ode-solutions" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="visualization-functions-for-ode-solutions"><span class="header-section-number">9.2</span> Visualization Functions for ODE Solutions</h2>
<p>Below are two functions that can be used to visualize the solutions of ODEs. The <code>plot_main_curves</code> function for plotting the main fields over time and the <code>plot_phase_plots</code> function for generating phase plots.</p>
<div id="67647043" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_main_curves(t, y, field_labels):</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">3</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(field_labels)):</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        plt.plot(t, y[:, i], label<span class="op">=</span>field_labels[i])</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Time'</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Fields'</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    plt.grid(<span class="va">True</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="8ebba6b9" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_phase_plots(y, field_labels):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine the number of components and phase plots</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    num_components <span class="op">=</span> y.shape[<span class="dv">1</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    num_phase_plots <span class="op">=</span> num_components <span class="op">*</span> (num_components <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Determine the number of columns and rows for phase plots</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    num_columns <span class="op">=</span> <span class="bu">min</span>(<span class="dv">3</span>, num_components)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    num_rows <span class="op">=</span> (num_phase_plots <span class="op">+</span> num_columns <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> num_columns</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    fig, axs <span class="op">=</span> plt.subplots(num_rows, num_columns, figsize<span class="op">=</span>(<span class="dv">7</span>, <span class="dv">3</span> <span class="op">*</span> num_rows))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ensure axs is always a 2D array</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> num_rows <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        axs <span class="op">=</span> [axs]  <span class="co"># Ensure axs is always a 2D array</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> num_columns <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        axs <span class="op">=</span> [[ax] <span class="cf">for</span> ax <span class="kw">in</span> axs]  <span class="co"># Ensure axs is always a 2D array</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    plot_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_components):</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, num_components):</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>            row <span class="op">=</span> plot_index <span class="op">//</span> num_columns</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>            col <span class="op">=</span> plot_index <span class="op">%</span> num_columns</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>            axs[row][col].plot(y[:, i], y[:, j], label<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>field_labels[i]<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>field_labels[j]<span class="sc">}</span><span class="ss">'</span>, color<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>            axs[row][col].set_title(<span class="ss">f'</span><span class="sc">{</span>field_labels[i]<span class="sc">}</span><span class="ss"> vs </span><span class="sc">{</span>field_labels[j]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>            axs[row][col].set_xlabel(field_labels[i])</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>            axs[row][col].set_ylabel(field_labels[j])</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>            axs[row][col].legend()</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>            axs[row][col].grid(<span class="va">True</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>            plot_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove empty subplots</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(plot_index, num_rows <span class="op">*</span> num_columns):</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>        fig.delaxes(axs.flatten()[k])</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="lotka-volterra-predator-prey-model-with-competition" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="lotka-volterra-predator-prey-model-with-competition"><span class="header-section-number">9.3</span> Lotka-Volterra Predator-Prey Model with Competition</h2>
<p>The Lotka-Volterra equations describe the dynamics of biological systems in which two species interact, one as a predator and the other as prey. The model captures the essential features of predator-prey relationships, such as population growth, predation, and competition for resources.</p>
<p>In <strong>ecological modeling</strong>, the primary motivation is to understand the intricate interactions within an ecosystem. This model helps ecologists predict changes in species populations over time, taking into account factors like predation and competition. Such predictions are crucial for conservation efforts, as they assist in managing wildlife reserves and studying the impact of invasive species on native populations.</p>
<p>In the field of <strong>epidemiology</strong>, the Lotka-Volterra model is used to simulate the spread of diseases among different populations, such as susceptible, infected, and recovered individuals. This application is vital for studying disease dynamics and evaluating the effectiveness of vaccination programs. It plays a crucial role in public health planning and developing strategies for disease control, ensuring that health officials can respond effectively to potential outbreaks.</p>
<p>In <strong>economics</strong>, the Lotka-Volterra model is employed to analyze competition and cooperation in market dynamics. By modeling competing companies or products, economists can predict market shares over time and understand competitive behaviors. This application is particularly useful for strategic business planning, allowing companies to anticipate market trends and make informed decisions to enhance their competitive edge.</p>
<p>For a complex system involving three species with both predation and competition, the equations are:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dx}{dt} &amp;= \alpha x - \beta xy - \gamma xz \\
\frac{dy}{dt} &amp;= -\delta y + \epsilon xy - \eta yz \\
\frac{dz}{dt} &amp;= \theta z - \iota xz - \kappa yz
\end{aligned}
\]</span></p>
<p>Rewriting these equations in matrix-vector form:</p>
<p><span class="math display">\[
\frac{d}{dt}
\begin{pmatrix}
x \\
y \\
z
\end{pmatrix}
=
\begin{pmatrix}
\alpha &amp; -\beta y &amp; -\gamma z \\
\epsilon x &amp; -\delta &amp; -\eta z \\
-\iota x &amp; -\kappa y &amp; \theta
\end{pmatrix}
\begin{pmatrix}
x \\
y \\
z
\end{pmatrix}
\]</span></p>
<p>In this form:</p>
<p><span class="math display">\[
\mathbf{y} =
\begin{pmatrix}
x \\
y \\
z
\end{pmatrix}
\quad \text{and} \quad
A(\mathbf{y}) =
\begin{pmatrix}
\alpha &amp; -\beta y &amp; -\gamma z \\
\epsilon x &amp; -\delta &amp; -\eta z \\
-\iota x &amp; -\kappa y &amp; \theta
\end{pmatrix}
\]</span></p>
<p><strong>Typical Parameter Ranges:</strong></p>
<ul>
<li><span class="math inline">\(\alpha\)</span>: Growth rate of prey (0.01 to 1)</li>
<li><span class="math inline">\(\beta\)</span>: Predation rate coefficient (0.001 to 0.1)</li>
<li><span class="math inline">\(\gamma\)</span>: Competition rate coefficient for <span class="math inline">\(x\)</span> (0.001 to 0.1)</li>
<li><span class="math inline">\(\delta\)</span>: Death rate of predator (0.01 to 1)</li>
<li><span class="math inline">\(\epsilon\)</span>: Growth rate coefficient for predator due to prey (0.001 to 0.1)</li>
<li><span class="math inline">\(\eta\)</span>: Competition rate coefficient for <span class="math inline">\(y\)</span> (0.001 to 0.1)</li>
<li><span class="math inline">\(\theta\)</span>: Growth rate of the third species (0.01 to 1)</li>
<li><span class="math inline">\(\iota\)</span>: Competition rate coefficient for <span class="math inline">\(z\)</span> (0.001 to 0.1)</li>
<li><span class="math inline">\(\kappa\)</span>: Competition rate coefficient for <span class="math inline">\(y\)</span> on <span class="math inline">\(z\)</span> (0.001 to 0.1)</li>
</ul>
<div id="cell-lotka_volterra" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lotka_volterra(y, t):</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    alpha, beta, gamma <span class="op">=</span> <span class="fl">0.1</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    delta, epsilon, eta <span class="op">=</span> <span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    theta, iota, kappa <span class="op">=</span> <span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    x, y, z <span class="op">=</span> y</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    dxdt <span class="op">=</span> alpha <span class="op">*</span> x <span class="op">-</span> beta <span class="op">*</span> x <span class="op">*</span> y <span class="op">-</span> gamma <span class="op">*</span> x <span class="op">*</span> z</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    dydt <span class="op">=</span> <span class="op">-</span>delta <span class="op">*</span> y <span class="op">+</span> epsilon <span class="op">*</span> x <span class="op">*</span> y <span class="op">-</span> eta <span class="op">*</span> y <span class="op">*</span> z</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    dzdt <span class="op">=</span> theta <span class="op">*</span> z <span class="op">-</span> iota <span class="op">*</span> x <span class="op">*</span> z <span class="op">-</span> kappa <span class="op">*</span> y <span class="op">*</span> z</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([dxdt, dydt, dzdt])</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial conditions and time setup</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> np.array([<span class="dv">40</span>, <span class="dv">9</span>, <span class="dv">3</span>])</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>t0, tf, dt <span class="op">=</span> <span class="dv">0</span>, <span class="dv">200</span>, <span class="fl">0.1</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(t0, tf, dt)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Solving the ODE</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> [y0]</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ti <span class="kw">in</span> t[:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    y_next <span class="op">=</span> runge_kutta_step(lotka_volterra, ys[<span class="op">-</span><span class="dv">1</span>], ti, dt)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    ys.append(y_next)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.array(ys)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>field_labels <span class="op">=</span> [<span class="st">'$x(t)$'</span>, <span class="st">'$y(t)$'</span>, <span class="st">'$z(t)$'</span>]</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>plot_main_curves(t, ys, field_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Dynamics of a Predator-Prey-Competition Model</figcaption>
<p><a href="05a_coupled_differential_equations_files/figure-html/lotka_volterra-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Dynamics of a Predator-Prey-Competition Model"><img src="05a_coupled_differential_equations_files/figure-html/lotka_volterra-output-1.png" width="585" height="282" alt="Dynamics of a Predator-Prey-Competition Model" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-lotka_volterra_phase" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>plot_phase_plots(ys, field_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Phase Dynamics of the Predator-Prey-Competition Model</figcaption>
<p><a href="05a_coupled_differential_equations_files/figure-html/lotka_volterra_phase-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Phase Dynamics of the Predator-Prey-Competition Model"><img src="05a_coupled_differential_equations_files/figure-html/lotka_volterra_phase-output-1.png" width="660" height="275" alt="Phase Dynamics of the Predator-Prey-Competition Model" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="competition-for-resources-model" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="competition-for-resources-model"><span class="header-section-number">9.4</span> Competition for Resources Model</h2>
<p>The three-species competing model describes the dynamics of three species competing for the same limited resources. It is used in several domains due to its ability to capture the dynamics of competition among multiple species or entities sharing <strong>common resources</strong>.</p>
<p>In <strong>ecological modeling</strong>, the motivation behind using this model is to understand the competitive interactions between multiple species within an ecosystem. By simulating how species compete for limited resources, the model helps ecologists predict changes in population sizes and the potential outcomes of competition. This understanding is crucial for ecosystem management and conservation biology, enabling the development of strategies to preserve biodiversity and maintain ecological balance.</p>
<p>In <strong>agricultural science</strong>, the model is used to study the competition between different crops or between crops and weeds. The primary motivation here is to optimize crop yields and develop effective weed control strategies. By modeling these interactions, agricultural scientists can determine the best practices for crop rotation, planting schedules, and the use of herbicides, ultimately leading to more sustainable and productive farming systems.</p>
<p>In <strong>sociology and economics</strong>, the three-species competing model can be applied to analyze competition between different social groups or businesses for shared resources. The motivation in this context is to understand the dynamics of competitive interactions and predict the outcomes of such competition. This application is particularly valuable for market analysis and strategic business planning, as it provides insights into how different entities compete, adapt, and coexist within a shared environment. By leveraging these insights, businesses and policymakers can make informed decisions to foster healthy competition and optimize resource allocation.</p>
<p>The three-species competing model consists of three species, each with its growth rate and carrying capacity, competing for shared resources. The model captures the interactions between species and how they influence each other’s population dynamics.</p>
<p>The equations are:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{du}{dt} &amp;= r_1 u \left( 1 - \frac{u}{K_1} - \alpha \frac{v}{K_1} - \beta \frac{w}{K_1} \right) \\
\frac{dv}{dt} &amp;= r_2 v \left( 1 - \frac{v}{K_2} - \gamma \frac{u}{K_2} - \delta \frac{w}{K_2} \right) \\
\frac{dw}{dt} &amp;= r_3 w \left( 1 - \frac{w}{K_3} - \epsilon \frac{u}{K_3} - \zeta \frac{v}{K_3} \right)
\end{aligned}
\]</span></p>
<p>Rewriting these equations in matrix-vector form:</p>
<p><span class="math display">\[
\frac{d}{dt}
\begin{pmatrix}
u \\
v \\
w
\end{pmatrix}
=
\begin{pmatrix}
r_1 \left( 1 - \frac{u}{K_1} - \alpha \frac{v}{K_1} - \beta \frac{w}{K_1} \right) \\
r_2 \left( 1 - \frac{v}{K_2} - \gamma \frac{u}{K_2} - \delta \frac{w}{K_2} \right) \\
r_3 \left( 1 - \frac{w}{K_3} - \epsilon \frac{u}{K_3} - \zeta \frac{v}{K_3} \right)
\end{pmatrix}
\]</span></p>
<p>This can be represented as:</p>
<p><span class="math display">\[
\frac{d}{dt}
\mathbf{y} =
\mathbf{R} \odot \left( \mathbf{1} - \frac{1}{\mathbf{K}} \mathbf{B} \mathbf{y} \right) \odot \mathbf{y}
\]</span></p>
<p>where: <span class="math display">\[
\mathbf{y} =
\begin{pmatrix}
u \\
v \\
w
\end{pmatrix},
\quad
\mathbf{R} =
\begin{pmatrix}
r_1 \\
r_2 \\
r_3
\end{pmatrix},
\quad
\mathbf{K} =
\begin{pmatrix}
K_1 \\
K_2 \\
K_3
\end{pmatrix},
\quad
\mathbf{B} =
\begin{pmatrix}
1 &amp; \alpha &amp; \beta \\
\gamma &amp; 1 &amp; \delta \\
\epsilon &amp; \zeta &amp; 1
\end{pmatrix}
\]</span></p>
<p>Here, <span class="math inline">\(\odot\)</span> denotes element-wise multiplication.</p>
<p><strong>Typical Parameter Ranges:</strong></p>
<ul>
<li><span class="math inline">\(r_1, r_2, r_3\)</span>: Growth rates of species (0.01 to 1)</li>
<li><span class="math inline">\(K_1, K_2, K_3\)</span>: Carrying capacities (500 to 2000)</li>
<li><span class="math inline">\(\alpha, \beta, \gamma, \delta, \epsilon, \zeta\)</span>: Competition coefficients (0.001 to 0.1)</li>
</ul>
<p><strong>Parameter Descriptions:</strong></p>
<ul>
<li><strong><span class="math inline">\(r_1, r_2, r_3\)</span>:</strong> Intrinsic growth rates of the species <span class="math inline">\(u\)</span>, <span class="math inline">\(v\)</span>, and <span class="math inline">\(w\)</span>, respectively.</li>
<li><strong><span class="math inline">\(K_1, K_2, K_3\)</span>:</strong> Carrying capacities of the species <span class="math inline">\(u\)</span>, <span class="math inline">\(v\)</span>, and <span class="math inline">\(w\)</span>, representing the maximum sustainable population in the absence of competitors.</li>
<li><strong><span class="math inline">\(\alpha, \beta, \gamma, \delta, \epsilon, \zeta\)</span>:</strong> Competition coefficients representing the impact of one species on another:
<ul>
<li><span class="math inline">\(\alpha\)</span>: Effect of species <span class="math inline">\(v\)</span> on species <span class="math inline">\(u\)</span></li>
<li><span class="math inline">\(\beta\)</span>: Effect of species <span class="math inline">\(w\)</span> on species <span class="math inline">\(u\)</span></li>
<li><span class="math inline">\(\gamma\)</span>: Effect of species <span class="math inline">\(u\)</span> on species <span class="math inline">\(v\)</span></li>
<li><span class="math inline">\(\delta\)</span>: Effect of species <span class="math inline">\(w\)</span> on species <span class="math inline">\(v\)</span></li>
<li><span class="math inline">\(\epsilon\)</span>: Effect of species <span class="math inline">\(u\)</span> on species <span class="math inline">\(w\)</span></li>
<li><span class="math inline">\(\zeta\)</span>: Effect of species <span class="math inline">\(v\)</span> on species <span class="math inline">\(w\)</span></li>
</ul></li>
</ul>
<div id="a7d31663" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> competing_species(y, t):</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    r1, r2, r3 <span class="op">=</span> <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    K1, K2, K3 <span class="op">=</span> <span class="dv">1000</span>, <span class="dv">1000</span>, <span class="dv">1000</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    alpha, beta, gamma <span class="op">=</span> <span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    delta, epsilon, zeta <span class="op">=</span> <span class="fl">0.01</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    u, v, w <span class="op">=</span> y</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    dudt <span class="op">=</span> r1 <span class="op">*</span> u <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> u <span class="op">/</span> K1 <span class="op">-</span> alpha <span class="op">*</span> v <span class="op">/</span> K1 <span class="op">-</span> beta <span class="op">*</span> w <span class="op">/</span> K1)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    dvdt <span class="op">=</span> r2 <span class="op">*</span> v <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> v <span class="op">/</span> K2 <span class="op">-</span> gamma <span class="op">*</span> u <span class="op">/</span> K2 <span class="op">-</span> delta <span class="op">*</span> w <span class="op">/</span> K2)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    dwdt <span class="op">=</span> r3 <span class="op">*</span> w <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> w <span class="op">/</span> K3 <span class="op">-</span> epsilon <span class="op">*</span> u <span class="op">/</span> K3 <span class="op">-</span> zeta <span class="op">*</span> v <span class="op">/</span> K3)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([dudt, dvdt, dwdt])</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> np.array([<span class="dv">50</span>, <span class="dv">3</span>, <span class="dv">20</span>])</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>t0, tf, dt <span class="op">=</span> <span class="dv">0</span>, <span class="dv">200</span>, <span class="fl">0.1</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(t0, tf, dt)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> [y0]</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ti <span class="kw">in</span> t[:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    y_next <span class="op">=</span> runge_kutta_step(competing_species, ys[<span class="op">-</span><span class="dv">1</span>], ti, dt)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    ys.append(y_next)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.array(ys)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>field_labels <span class="op">=</span> [<span class="st">'$u(t)$'</span>, <span class="st">'$v(t)$'</span>, <span class="st">'$w(t)$'</span>]</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>plot_main_curves(t, ys, field_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Dynamics of the 3-species Model</figcaption>
<p><a href="05a_coupled_differential_equations_files/figure-html/cell-8-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Dynamics of the 3-species Model"><img src="05a_coupled_differential_equations_files/figure-html/cell-8-output-1.png" width="601" height="282" alt="Dynamics of the 3-species Model" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="22372fc0" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plot_phase_plots(ys, field_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Phases of the 3-species Model</figcaption>
<p><a href="05a_coupled_differential_equations_files/figure-html/cell-9-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Phases of the 3-species Model"><img src="05a_coupled_differential_equations_files/figure-html/cell-9-output-1.png" width="662" height="276" alt="Phases of the 3-species Model" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="coupled-oscillators-model" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="coupled-oscillators-model"><span class="header-section-number">9.5</span> Coupled Oscillators Model</h2>
<p>The coupled oscillators model describes the dynamics of multiple oscillators that are interconnected, influencing each other’s motion.</p>
<p>In <strong>mechanical systems</strong>, the primary motivation for using this model is to understand the behavior of interconnected mechanical oscillators, such as coupled pendulums or masses connected by springs. By analyzing the interactions between these oscillators, engineers can predict the dynamic responses of complex mechanical systems. This understanding is essential for designing stable and efficient structures, machinery, and vehicles, ensuring that they can withstand vibrations and other dynamic forces.</p>
<p>In <strong>electrical circuits</strong>, the three-oscillators model is used to study the behavior of coupled electrical oscillators, such as LC circuits that interact through mutual inductance or capacitance. The motivation here is to design and analyze electronic devices like filters, oscillators, and signal processors. By modeling the interactions between these electrical components, engineers can optimize the performance of electronic circuits and systems, enhancing their functionality and reliability in various applications, from communications to consumer electronics.</p>
<p>In <strong>biological systems</strong>, the model is applied to understand the behavior of coupled biological oscillators, such as neurons in the brain or circadian rhythms in living organisms. The motivation is to gain insights into how biological systems synchronize and maintain their rhythmic activities. This application is crucial in fields like neuroscience, where understanding the synchronization of neuronal oscillations can shed light on brain function and disorders. In chronobiology, the model helps researchers study the mechanisms underlying biological clocks, contributing to the development of treatments for sleep disorders and optimizing schedules for shift workers.</p>
<p>For three coupled oscillators, the equations are:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{d^2 x_1}{dt^2} &amp;= -k_1 x_1 + k_2 (x_2 - x_1) + k_3 (x_3 - x_1) \\
\frac{d^2 x_2}{dt^2} &amp;= -k_2 x_2 + k_1 (x_1 - x_2) + k_3 (x_3 - x_2) \\
\frac{d^2 x_3}{dt^2} &amp;= -k_3 x_3 + k_1 (x_1 - x_3) + k_2 (x_2 - x_3)
\end{aligned}
\]</span></p>
<p>Rewriting these equations in matrix-vector form, we have:</p>
<p><span class="math display">\[
\mathbf{M} \frac{d^2 \mathbf{x}}{dt^2} = \mathbf{K} \mathbf{x}
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
\mathbf{x} =
\begin{pmatrix}
x_1 \\
x_2 \\
x_3
\end{pmatrix},
\quad
\mathbf{M} =
\begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{pmatrix},
\quad
\mathbf{K} =
\begin{pmatrix}
-k_1 - k_2 - k_3 &amp; k_2 &amp; k_3 \\
k_1 &amp; -k_1 - k_2 - k_3 &amp; k_3 \\
k_1 &amp; k_2 &amp; -k_1 - k_2 - k_3
\end{pmatrix}
\]</span></p>
<p><strong>Typical Parameter Ranges:</strong></p>
<ul>
<li><span class="math inline">\(k_1, k_2, k_3\)</span>: Coupling constants (0.1 to 10)</li>
</ul>
<p><strong>Parameter Descriptions:</strong></p>
<ul>
<li><strong><span class="math inline">\(k_1, k_2, k_3\)</span>:</strong> Coupling constants representing the strength of the interaction between oscillators.
<ul>
<li><span class="math inline">\(k_1\)</span>: Coupling between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span></li>
<li><span class="math inline">\(k_2\)</span>: Coupling between <span class="math inline">\(x_2\)</span> and <span class="math inline">\(x_3\)</span></li>
<li><span class="math inline">\(k_3\)</span>: Coupling between <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_3\)</span></li>
</ul></li>
</ul>
<div id="fefbbec1" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> coupled_oscillators(y, t):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    k1, k2, k3 <span class="op">=</span> <span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x1, x2, x3, v1, v2, v3 <span class="op">=</span> y</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    dx1dt <span class="op">=</span> v1</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    dx2dt <span class="op">=</span> v2</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    dx3dt <span class="op">=</span> v3</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    dv1dt <span class="op">=</span> <span class="op">-</span>k1 <span class="op">*</span> x1 <span class="op">+</span> k2 <span class="op">*</span> (x2 <span class="op">-</span> x1) <span class="op">+</span> k3 <span class="op">*</span> (x3 <span class="op">-</span> x1)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    dv2dt <span class="op">=</span> <span class="op">-</span>k2 <span class="op">*</span> x2 <span class="op">+</span> k1 <span class="op">*</span> (x1 <span class="op">-</span> x2) <span class="op">+</span> k3 <span class="op">*</span> (x3 <span class="op">-</span> x2)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    dv3dt <span class="op">=</span> <span class="op">-</span>k3 <span class="op">*</span> x3 <span class="op">+</span> k1 <span class="op">*</span> (x1 <span class="op">-</span> x3) <span class="op">+</span> k2 <span class="op">*</span> (x2 <span class="op">-</span> x3)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([dx1dt, dx2dt, dx3dt, dv1dt, dv2dt, dv3dt])</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>t0, tf, dt <span class="op">=</span> <span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.1</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(t0, tf, dt)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> [y0]</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ti <span class="kw">in</span> t[:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    y_next <span class="op">=</span> runge_kutta_step(coupled_oscillators, ys[<span class="op">-</span><span class="dv">1</span>], ti, dt)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    ys.append(y_next)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.array(ys)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>field_labels_displacements <span class="op">=</span> [<span class="st">'$u_1$'</span>, <span class="st">'$u_2$'</span>, <span class="st">'$u_3$'</span>]</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>plot_main_curves(t, ys[:, <span class="dv">0</span>:<span class="dv">3</span>], field_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Dynamics of the Coupled Oscillators Model</figcaption>
<p><a href="05a_coupled_differential_equations_files/figure-html/cell-10-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Dynamics of the Coupled Oscillators Model"><img src="05a_coupled_differential_equations_files/figure-html/cell-10-output-1.png" width="600" height="282" alt="Dynamics of the Coupled Oscillators Model" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="bb602174" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>field_labels_all <span class="op">=</span> [<span class="st">'$u_1$'</span>, <span class="st">'$u_2$'</span>, <span class="st">'$u_3$'</span>, <span class="st">'$v_1$'</span>, <span class="st">'$v_2$'</span>, <span class="st">'$v_3$'</span>]</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>plot_phase_plots(ys, field_labels_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Phases of the Coupled Oscillators Model</figcaption>
<p><a href="05a_coupled_differential_equations_files/figure-html/cell-11-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Phases of the Coupled Oscillators Model"><img src="05a_coupled_differential_equations_files/figure-html/cell-11-output-1.png" width="663" height="1431" alt="Phases of the Coupled Oscillators Model" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sir-model-with-immunization-and-birth-rate" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="sir-model-with-immunization-and-birth-rate"><span class="header-section-number">9.6</span> SIR Model with Immunization and Birth Rate</h2>
<p>The SIR model (Susceptible, Infected, Recovered) is a foundational tool in epidemiology and public health, used to describe the spread of infectious diseases within a population. Its applications extend to various fields where understanding the dynamics of disease transmission is crucial.</p>
<p>In <strong>epidemiology</strong>, the primary motivation for using the SIR model is to understand how infectious diseases propagate through populations. By dividing the population into three compartments—susceptible (S), infected (I), and recovered (R)—the model helps predict the course of an epidemic and the potential outcomes of different intervention strategies. This is vital for public health planning, as it allows health officials to estimate the impact of measures such as vaccination, quarantine, and social distancing. The SIR model aids in the development of effective disease control strategies, helping to minimize the spread and impact of infectious diseases.</p>
<p>In <strong>public health</strong>, the SIR model is used to evaluate the effectiveness of public health interventions and inform policy decisions. The motivation here is to assess how interventions like immunization programs and public awareness campaigns can alter the course of an epidemic. By simulating various scenarios, public health officials can optimize resource allocation and response strategies to better manage outbreaks. This application is crucial for preparing and responding to epidemics and pandemics, ensuring that public health systems are equipped to protect communities effectively.</p>
<p>In <strong>population biology</strong>, the SIR model helps researchers study disease dynamics in animal populations. The motivation is to understand how diseases spread among wildlife and livestock, which can have significant implications for conservation and agriculture. By modeling the transmission of diseases within and between animal species, researchers can develop strategies to manage outbreaks, prevent the spread of zoonotic diseases to humans, and protect endangered species. This application is essential for maintaining healthy ecosystems and sustainable agricultural practices.</p>
<p>The SIR model with immunization and birth rate describes the dynamics of an infectious disease within a population. The population is divided into three compartments: susceptible (S), infected (I), and recovered (R). The equations are:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dS}{dt} &amp;= \mu (S + I + R) - \beta SI - \mu S \\
\frac{dI}{dt} &amp;= \beta SI - (\gamma + \mu) I \\
\frac{dR}{dt} &amp;= \gamma I - \mu R
\end{aligned}
\]</span></p>
<p>Rewriting these equations in matrix-vector form:</p>
<p><span class="math display">\[
\frac{d}{dt}
\begin{pmatrix}
S \\
I \\
R
\end{pmatrix}
=
\begin{pmatrix}
-\beta I - \mu &amp; 0 &amp; 0 \\
\beta S &amp; -(\gamma + \mu) &amp; 0 \\
0 &amp; \gamma &amp; -\mu
\end{pmatrix}
\begin{pmatrix}
S \\
I \\
R
\end{pmatrix}
+
\begin{pmatrix}
\mu (S + I + R) \\
0 \\
0
\end{pmatrix}
\]</span></p>
<p>In this form:</p>
<p><span class="math display">\[
\mathbf{y} =
\begin{pmatrix}
S \\
I \\
R
\end{pmatrix}
\quad \text{and} \quad
A(\mathbf{y}) =
\begin{pmatrix}
-\beta I - \mu &amp; 0 &amp; 0 \\
\beta S &amp; -(\gamma + \mu) &amp; 0 \\
0 &amp; \gamma &amp; -\mu
\end{pmatrix}
\]</span></p>
<p><strong>Typical Parameter Ranges:</strong></p>
<ul>
<li><span class="math inline">\(\beta\)</span>: Transmission rate (0.1 to 1)</li>
<li><span class="math inline">\(\gamma\)</span>: Recovery rate (0.01 to 0.5)</li>
<li><span class="math inline">\(\mu\)</span>: Birth/Death rate (0.001 to 0.01)</li>
</ul>
<p><strong>Parameter Descriptions:</strong></p>
<ul>
<li><strong><span class="math inline">\(\beta\)</span>:</strong> Transmission rate, representing the rate at which susceptible individuals become infected upon contact with infected individuals.</li>
<li><strong><span class="math inline">\(\gamma\)</span>:</strong> Recovery rate, representing the rate at which infected individuals recover and move to the recovered compartment.</li>
<li><strong><span class="math inline">\(\mu\)</span>:</strong> Birth/Death rate, representing the rate at which individuals are born into the susceptible compartment and the natural death rate across all compartments.</li>
</ul>
<div id="214daadc" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sir_model(y, t):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    mu, beta, gamma <span class="op">=</span> <span class="fl">0.01</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    S, I, R <span class="op">=</span> y</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    dSdt <span class="op">=</span> mu <span class="op">*</span> (S <span class="op">+</span> I <span class="op">+</span> R) <span class="op">-</span> beta <span class="op">*</span> S <span class="op">*</span> I <span class="op">-</span> mu <span class="op">*</span> S</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    dIdt <span class="op">=</span> beta <span class="op">*</span> S <span class="op">*</span> I <span class="op">-</span> (gamma <span class="op">+</span> mu) <span class="op">*</span> I</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    dRdt <span class="op">=</span> gamma <span class="op">*</span> I <span class="op">-</span> mu <span class="op">*</span> R</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([dSdt, dIdt, dRdt])</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> np.array([<span class="fl">0.99</span>, <span class="fl">0.01</span>, <span class="fl">0.0</span>])</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>t0, tf, dt <span class="op">=</span> <span class="dv">0</span>, <span class="dv">160</span>, <span class="fl">0.1</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.arange(t0, tf, dt)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> [y0]</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ti <span class="kw">in</span> t[:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    y_next <span class="op">=</span> runge_kutta_step(sir_model, ys[<span class="op">-</span><span class="dv">1</span>], ti, dt)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    ys.append(y_next)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> np.array(ys)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>field_labels <span class="op">=</span> [<span class="st">'$S(t)$'</span>, <span class="st">'$I(t)$'</span>, <span class="st">'$R(t)$'</span>]</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>plot_main_curves(t, ys, field_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Dynamics of the SIR Model with Immunization and Birth Rate</figcaption>
<p><a href="05a_coupled_differential_equations_files/figure-html/cell-12-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Dynamics of the SIR Model with Immunization and Birth Rate"><img src="05a_coupled_differential_equations_files/figure-html/cell-12-output-1.png" width="589" height="282" alt="Dynamics of the SIR Model with Immunization and Birth Rate" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="5ac6081e" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>plot_phase_plots(ys, field_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<figcaption>Phases of the SIR Model with Immunization and Birth Rate</figcaption>
<p><a href="05a_coupled_differential_equations_files/figure-html/cell-13-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Phases of the SIR Model with Immunization and Birth Rate"><img src="05a_coupled_differential_equations_files/figure-html/cell-13-output-1.png" width="661" height="276" alt="Phases of the SIR Model with Immunization and Birth Rate" class="figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">9.7</span> Conclusion</h2>
<p>Ordinary Differential Equations (ODEs) are a powerful tool for understanding the world around us. While fitting empirical data is useful for some purposes, ODEs offer a deeper, more insightful way to study complex systems. They are excellent at showing how things change over time and how different variables interact with each other. ODEs help us understand not just the current state of a system but how it evolves. For example, Newton’s laws of motion, expressed as ODEs, explain how forces cause changes in the movement of objects. This level of understanding goes beyond what we can get from data points alone.</p>
<p>One of the strengths of ODEs is their ability to <strong>predict future behavior</strong>. Once we have an ODE model, we can use it to forecast what will happen under different conditions, even if we don’t have data for those scenarios. For instance, the Lotka-Volterra equations can predict how predator and prey populations will change over time, giving us insights into future population dynamics. ODE models are often very <strong>general and can be applied to various systems with similar principles</strong>. This means that a model developed for one situation can often be adapted for another. For example, the SIR model, which is used to study the spread of diseases, can be modified to apply to different diseases and populations, showing its versatility. Developing ODE models forces us to think deeply about the systems we are studying, often leading to <strong>new hypotheses and discoveries</strong>. For example, in ecology, ODEs that describe interactions between species can suggest new ideas about how species compete for resources or maintain ecological balance. This process of building and refining models is a key part of scientific discovery.</p>
<p>Complex systems with many interacting parts and feedback loops can be difficult to understand with empirical data alone. ODEs provide a <strong>structured way to analyze these interactions and understand the overall behavior of the system</strong>. Climate models, for example, use ODEs to represent the interactions between the atmosphere, oceans, and land, helping us understand climate change. Empirical data can be limited by the conditions under which it was collected, and it may include noise or biases. While data fitting is helpful, it might not capture all the important dynamics of a system. ODEs, informed by empirical data but based on theoretical principles, offer a more robust framework for understanding and prediction. By using ODEs, we can move beyond mere observation to a deeper understanding and more effective management of the complex systems that shape our world.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./08_scientific_computing_using_scipy.html" class="pagination-link" aria-label="Scientific Python (SciPy)">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Scientific Python (SciPy)</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08a_partial_differential_equations.html" class="pagination-link" aria-label="Partial Differential Equations">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Partial Differential Equations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024, Jithender Timothy</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","selector":".lightbox","descPosition":"bottom","closeEffect":"zoom","loop":false});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>